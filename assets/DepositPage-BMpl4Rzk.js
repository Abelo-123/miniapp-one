import{r,j as e}from"./react-vendor-C-oIHjE7.js";import{u as g,f as l,h as N,i as n,b as y}from"./index-DIIM9q27.js";import{L as S,b as p,I as b,B as h,P as D}from"./tma-ui-zNZ4TOi0.js";import"./tma-sdk-B1EfXx2E.js";const T=[100,500,1e3,2e3];function I(){const{user:a,deposits:i,setBalance:m,setDeposits:u,showToast:d}=g(),[t,o]=r.useState(""),[x,c]=r.useState(!1),j=async()=>{const s=parseInt(t);if(!s||s<50){d("error","Minimum deposit is 50 ETB"),n("error");return}c(!0);try{await new Promise(v=>setTimeout(v,1500)),a&&m(a.balance+s);const f={id:Math.floor(Math.random()*9e4)+1e4,amount:s,reference_id:`CP_${Math.random().toString(36).substr(2,9).toUpperCase()}`,status:"completed",method:"Chapa",created_at:new Date().toISOString()};u([f,...i]),d("success",`Deposited ${l(s)} successfully!`),y("heavy"),n("success"),o("")}catch{d("error","Payment failed"),n("error")}finally{c(!1)}};return e.jsxs(S,{children:[e.jsx(p,{children:e.jsx("div",{style:{padding:"16px"},children:e.jsxs("div",{className:"dp-balance",children:[e.jsx("span",{style:{color:"var(--tg-theme-hint-color)",fontSize:"13px"},children:"Current Balance"}),e.jsx("div",{style:{fontSize:"24px",fontWeight:"bold"},children:a?l(a.balance):"Loading..."})]})})}),e.jsxs(p,{header:"Add Funds",children:[e.jsx(b,{header:"Amount",placeholder:"Enter amount (min 50)",type:"number",value:t,onChange:s=>o(s.target.value)}),e.jsx("div",{style:{padding:"12px 16px",display:"flex",gap:8,overflowX:"auto"},children:T.map(s=>e.jsxs(h,{size:"s",mode:"bezeled",onClick:()=>{N(),o(String(s))},children:["+",s]},s))}),e.jsx("div",{style:{padding:"16px"},children:e.jsx(h,{size:"l",stretched:!0,onClick:j,loading:x,disabled:!t||parseInt(t)<50,children:"Deposit via Chapa"})})]}),e.jsxs("div",{className:"dp-table-container",children:[e.jsxs("div",{className:"dp-table-header",children:[e.jsx("div",{className:"dp-col dp-col-id",children:"ORDER ID"}),e.jsx("div",{className:"dp-col dp-col-amount",children:"AMOUNT"}),e.jsx("div",{className:"dp-col dp-col-ref",children:"TRANSACTION"}),e.jsx("div",{className:"dp-col dp-col-date",children:"DATE"})]}),i.length===0?e.jsx(D,{description:"No deposits yet"}):i.map(s=>e.jsxs("div",{className:"dp-table-row",children:[e.jsxs("div",{className:"dp-col dp-col-id",children:["#",s.id]}),e.jsx("div",{className:"dp-col dp-col-amount",children:s.amount}),e.jsx("div",{className:"dp-col dp-col-ref",children:s.reference_id}),e.jsx("div",{className:"dp-col dp-col-date",children:new Date(s.created_at).toLocaleDateString(void 0,{month:"numeric",day:"numeric",year:"2-digit"})})]},s.id))]})]})}export{I as DepositPage};
