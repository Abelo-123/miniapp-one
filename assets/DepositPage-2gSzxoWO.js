import{r as p,j as t}from"./react-vendor-C-oIHjE7.js";import{u as b,f as o,h as y,i as c,b as v}from"./index-C6osAsRO.js";import{L as S,b as l,e as w,I as B,B as h,C as u}from"./tma-ui-BXUja-_9.js";import"./tma-sdk-B1EfXx2E.js";const C=[100,500,1e3,2e3];function z(){const{user:s,deposits:n,setBalance:m,setDeposits:x,showToast:i}=b(),[a,r]=p.useState(""),[f,d]=p.useState(!1),g=async()=>{const e=parseInt(a);if(!e||e<50){i("error","Minimum deposit is 50 ETB"),c("error");return}d(!0);try{await new Promise(D=>setTimeout(D,1500)),s&&m(s.balance+e);const j={id:Date.now(),amount:e,reference_id:`chapa-${Date.now()}`,status:"completed",method:"Chapa",created_at:new Date().toISOString()};x([j,...n]),i("success",`Deposited ${o(e)} successfully!`),v("heavy"),c("success"),r("")}catch{i("error","Payment failed"),c("error")}finally{d(!1)}};return t.jsxs(S,{children:[t.jsx(l,{children:t.jsx(w,{header:"Current Balance",description:s?o(s.balance):"Loading...",background:"var(--tg-theme-secondary-bg-color)",children:t.jsx("div",{style:{fontSize:"2em",fontWeight:"bold",color:"var(--tg-theme-text-color)"},children:s?o(s.balance):"..."})})}),t.jsxs(l,{header:"Deposit Funds",children:[t.jsx(B,{header:"Amount (ETB)",placeholder:"Enter amount (min 50)",type:"number",value:a,onChange:e=>r(e.target.value)}),t.jsx("div",{style:{padding:"12px 16px",display:"flex",gap:8,overflowX:"auto"},children:C.map(e=>t.jsxs(h,{size:"s",mode:"bezeled",onClick:()=>{y(),r(String(e))},children:["+",e]},e))}),t.jsx("div",{style:{padding:"0 16px 16px"},children:t.jsx(h,{size:"l",stretched:!0,onClick:g,loading:f,disabled:!a||parseInt(a)<50,children:"Deposit with Chapa"})})]}),t.jsx(l,{header:"Recent Deposits",children:n.length===0?t.jsx(u,{disabled:!0,children:"No recent deposits"}):n.map(e=>t.jsx(u,{after:t.jsxs("span",{style:{color:"var(--tg-theme-link-color)"},children:["+",o(e.amount)]}),description:new Date(e.created_at).toLocaleDateString(),subtitle:e.status,children:e.method},e.id))})]})}export{z as DepositPage};
