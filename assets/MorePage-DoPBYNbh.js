import{r as i,j as e}from"./react-vendor-C-oIHjE7.js";import{u as j}from"./index-D32_aHZK.js";import{L as v,b as d,C as l,d as b,P as y,I as S,B as w}from"./tma-ui-BXUja-_9.js";import"./tma-sdk-B1EfXx2E.js";function R(){const{user:s,alerts:n,chatMessages:r,setChatMessages:u,unreadAlerts:o,setUnreadAlerts:p,setAlerts:g,showToast:x}=j(),[a,c]=i.useState(""),h=i.useRef(null);i.useEffect(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[r]);const m=()=>{o>0&&(p(0),g(n.map(t=>({...t,is_read:!0}))))},f=()=>{if(!a.trim())return;const t={id:Date.now(),sender:"user",message:a.trim(),created_at:new Date().toISOString()};u([...r,t]),c(""),x("info","Message sent to support")};return e.jsxs(v,{children:[e.jsx(d,{children:s?e.jsx(l,{before:e.jsx(b,{src:s.photo_url||"",size:48,fallbackIcon:e.jsx("span",{children:"ðŸ‘¤"})}),description:`ID: ${s.id}`,multiline:!0,children:s.display_name}):e.jsx(l,{children:"Please log in"})}),e.jsx(d,{header:`Notifications ${o>0?`(${o})`:""}`,children:n.length===0?e.jsx(y,{description:"No notifications yet"}):n.map(t=>e.jsx(l,{multiline:!0,description:new Date(t.created_at).toLocaleDateString(),onClick:m,before:!t.is_read&&e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",background:"var(--tg-theme-accent-text-color, var(--tg-theme-button-color))",marginRight:8}}),children:t.message},t.id))}),e.jsxs(d,{header:"Live Support",children:[e.jsxs("div",{style:{height:300,overflowY:"auto",padding:10,background:"var(--tg-theme-secondary-bg-color)"},children:[r.length===0?e.jsx("div",{style:{textAlign:"center",color:"var(--tg-theme-hint-color)",padding:20},children:"Start a conversation with support"}):r.map(t=>e.jsx("div",{style:{display:"flex",justifyContent:t.sender==="user"?"flex-end":"flex-start",marginBottom:8},children:e.jsx("div",{style:{background:t.sender==="user"?"var(--tg-theme-button-color)":"var(--tg-theme-bg-color)",color:t.sender==="user"?"var(--tg-theme-button-text-color)":"var(--tg-theme-text-color)",padding:"8px 12px",borderRadius:12,maxWidth:"80%",fontSize:14},children:t.message})},t.id)),e.jsx("div",{ref:h})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:8},children:[e.jsx(S,{placeholder:"Type a message...",value:a,onChange:t=>c(t.target.value)}),e.jsx(w,{size:"s",onClick:f,disabled:!a.trim(),children:"Send"})]})]})]})}export{R as MorePage};
