import{r as c,j as t}from"./react-vendor-C-oIHjE7.js";import{u as f,h as j,f as y,b as v}from"./index-D32_aHZK.js";import{L as S,b as d,I as b,B as p,P as C,C as _}from"./tma-ui-BXUja-_9.js";import"./tma-sdk-B1EfXx2E.js";const w=[{id:"all",label:"All"},{id:"pending",label:"Pending"},{id:"processing",label:"Processing"},{id:"completed",label:"Completed"},{id:"cancelled",label:"Cancelled"}];function h(l){const s=l.toLowerCase();return s==="in_progress"?"processing":s==="canceled"?"cancelled":s}function z(l){return new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function P(){const{orders:l,showToast:s}=f(),[n,u]=c.useState("all"),[r,m]=c.useState(""),o=c.useMemo(()=>{let e=l;if(n!=="all"&&(e=e.filter(i=>h(i.status)===n)),r.trim()){const i=r.toLowerCase();e=e.filter(a=>a.service_name.toLowerCase().includes(i)||a.api_order_id.toString().includes(i)||a.link.toLowerCase().includes(i))}return e},[l,n,r]),x=e=>{v("medium"),s("info",`Refill request sent for order #${e}`)};return t.jsxs(S,{children:[t.jsxs(d,{children:[t.jsx(b,{placeholder:"Search orders...",value:r,onChange:e=>m(e.target.value)}),t.jsx("div",{style:{padding:"12px 16px",overflowX:"auto",display:"flex",gap:8,scrollbarWidth:"none",msOverflowStyle:"none",background:"var(--tg-theme-bg-color)"},children:w.map(e=>t.jsx(p,{size:"s",mode:n===e.id?"filled":"bezeled",onClick:()=>{j(),u(e.id)},children:e.label},e.id))})]}),o.length===0?t.jsx(C,{header:"No Orders Found",description:r.trim()||n!=="all"?"Try adjusting your filters":"You haven't placed any orders yet."}):t.jsx(d,{header:`Orders (${o.length})`,children:o.map(e=>{const i=h(e.status),a=i==="completed";return t.jsx(_,{multiline:!0,description:t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:4},children:[t.jsx("div",{style:{fontSize:"13px",color:"var(--tg-theme-link-color)"},children:e.link}),t.jsxs("div",{style:{display:"flex",gap:12,fontSize:"12px",color:"var(--tg-theme-hint-color)"},children:[t.jsxs("span",{children:["Qty: ",e.quantity]}),t.jsxs("span",{children:["Start: ",e.start_count]}),t.jsxs("span",{children:["Remains: ",e.remains]})]}),t.jsx("div",{style:{fontSize:"12px",color:"var(--tg-theme-hint-color)"},children:z(e.created_at)})]}),after:t.jsxs("div",{style:{textAlign:"right",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:4},children:[t.jsx("div",{style:{fontWeight:600},children:y(e.charge)}),t.jsx("div",{style:{fontSize:"11px",padding:"2px 6px",borderRadius:"4px",backgroundColor:"var(--tg-theme-secondary-bg-color)",color:"var(--tg-theme-text-color)"},children:i.toUpperCase()}),a&&t.jsx(p,{size:"s",mode:"plain",onClick:g=>{g.stopPropagation(),x(e.api_order_id)},children:"Refill"})]}),children:t.jsxs("span",{style:{fontWeight:600},children:["#",e.api_order_id," ",e.service_name]})},e.id)})})]})}export{P as HistoryPage};
